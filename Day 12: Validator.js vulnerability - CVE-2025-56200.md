# Alert Title: Validator.js vulnerability - CVE-2025-56200
<br>

## **Description**
CVE-2025-56200 is a medium-severity URL validation bypass vulnerability in the popular JavaScript library validator.js (versions up to 13.15.15) that can lead to Cross-Site Scripting (XSS) and Open Redirect attacks.The `validator.js` library allows attackers to bypass URL validation using the `isURL()` function. <br>
The isURL() function uses '://' as a delimiter to parse protocols, while browsers use ':' as the delimiter. This parsing difference allows attackers to bypass protocol and domain validation by crafting URLs leading to XSS and Open Redirect attacks. <br>
This flaw can enable **maliciously crafted URLs** to bypass application security controls, potentially leading to open redirect attacks, cross-Site scripting (XSS), server-side request forgery (SSRF) if used in URL allowlists. 
<br>
Key risk indicators for detection: <br>
■ Requests containing unusual or malformed URL schemes (e.g., `javascript:`, `data:`, `vbscript:`). <br>
■ Requests that include obfuscated or encoded URL payloads. <br>
■ Repeated failed URL validation attempts followed by successful redirects or script execution. <br>
■ Unexpected sources scanning or submitting URL parameters to endpoints that rely on `validator.isURL()`. <br>
<br>
<br>

## **Threats**
■ **No current threat groups associated with this vulnerability yet.**

<br>
<br>

## **MITRE ATT&CK Techniques**

### **Tactics**
■ Initial Access <br>
■ Execution <br>
■ Defense Evasion <br>

<br>

### **Techniques**
■ **T1190 – Exploit Public-Facing Application**: https://attack.mitre.org/techniques/T1190/ <br>
■ **T1059 – Command and Script Execution**: https://attack.mitre.org/techniques/T1059/ <br>
■ **T1036 – Masquerading**: https://attack.mitre.org/techniques/T1036/ <br>

<br>
<br>

## **Severity**
**Medium - High**: Detects attempts to exploit URL validation logic in web applications using `validator.js` versions prior to 13.15.20. <br>

<br>
<br>

## **Detection Type** 
■ Behavioural Detection  <br>
■ TTP‑based  <br>

<br>

## **Data Sources**
### **Microsoft Sentinel**
■ **Microsoft XDR Telemetry**: `DeviceFileEvents` `DeviceProcessEvents`

<br>

## **False Positives**
■ Legitimate redirects using uncommon or encoded URL schemes <br>
■ OAuth or SSO callback URLs <br>
■ URL shorteners or tracking services <br>
■ Security testing or QA activity <br>
■ Web crawlers or automated scanners <br>

<br>

--- 

## **KQL Query 1**

```kusto
let vulnerableVersion = "13.15.20";
DeviceFileEvents
| where FileName has "validator.js"
| extend FileVersion = tostring(FileVersionInfo.FileVersion)
| summarize FirstSeen = min(Timestamp),
            LastSeen = max(Timestamp),
            Machines = make_set(DeviceName),
            Versions = make_set(FileVersion)
by FolderPath
| extend IsVulnerable = array_length(array_filter(Versions, (v) => v < vulnerableVersion))
| where IsVulnerable > 0
| order by LastSeen desc


```

--- 
<br>
<br>

## **KQL Query 2**

```kusto
DeviceProcessEvents
| where ProcessCommandLine has "validator.js"
| extend FileVersion = tostring(FileVersionInfo.FileVersion)
| summarize Machines = make_set(DeviceName), Versions = make_set(FileVersion)
by ProcessName
| extend IsVulnerable = array_length(
    array_filter( Versions, (v) => v < "13.15.20")
)
| where IsVulnerable > 0



```

--- 

<br>

## **References**
■ GitHub (2025) validator.js has a URL validation bypass vulnerability in its isURL function [Online]. Available at: https://github.com/advisories/GHSA-9965-vmph-33xx <br>
■ National Vulnabilitiy Database (2025) CVE-2025-56200 Detail [Online]. Available at: https://nvd.nist.gov/vuln/detail/CVE-2025-56200 <br>

<br>

## **Author**
**Faiza Aslam**
